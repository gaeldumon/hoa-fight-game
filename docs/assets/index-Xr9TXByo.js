var t=Object.defineProperty,e=(e,s,i)=>((e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i)(e,"symbol"!=typeof s?s+"":s,i);import{p as s}from"./phaser-CrGWs1g-.js";function i(t){return t.game.scale.width}function a(t){return t.game.scale.height}!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const h=4409081,r=15346979,n="#ffffff",c=16777215,o={right:s.Input.Keyboard.KeyCodes.RIGHT,left:s.Input.Keyboard.KeyCodes.LEFT,jump:s.Input.Keyboard.KeyCodes.UP,shoot:s.Input.Keyboard.KeyCodes.SHIFT},l={right:s.Input.Keyboard.KeyCodes.D,left:s.Input.Keyboard.KeyCodes.Q,jump:s.Input.Keyboard.KeyCodes.Z,shoot:s.Input.Keyboard.KeyCodes.S},d="Marker Felt, fantasy, Comic Sans MS, Comic Sans, cursive";class u{constructor(t){e(this,"map"),e(this,"tileset"),e(this,"_mainLayer"),e(this,"subLayer"),this.map=t.scene.make.tilemap({key:`level${t.id}`}),this.tileset=this.map.addTilesetImage(`level${t.id}-tilesheet`,`level${t.id}Tilesheet`),this._mainLayer=this.map.createLayer("mainLayer",this.tileset,0,0),this._mainLayer.setCollisionByProperty({collides:!0}),this.subLayer=this.map.createLayer("subLayer",this.tileset,0,0)}get mainLayer(){return this._mainLayer}}class y{constructor(t){e(this,"scene"),e(this,"id"),e(this,"_tilemap"),e(this,"_name"),e(this,"_thumbnailKey"),e(this,"backgroundKey"),e(this,"musicKey"),this.id=t.id,this._name=t.name,this.backgroundKey=`level${this.id}Background`,this.musicKey=`level${this.id}Theme`,this._thumbnailKey=`level${this.id}Thumbnail`}get tilemap(){return this._tilemap}get name(){return this._name}get thumbnailKey(){return this._thumbnailKey}create(t){this.scene=t,this.scene.add.image(i(this.scene)/2,a(this.scene)/2,this.backgroundKey),this._tilemap=new u({scene:this.scene,id:this.id}),this.scene.sound.add(this.musicKey).play()}}class m{constructor(t){e(this,"_id"),e(this,"_username"),e(this,"_ratio"),e(this,"_screenSide"),e(this,"_characterInstance"),e(this,"_playerInstance"),e(this,"_levelInstance"),this._id=t.id,this._username=t.username,this._ratio=t.ratio,this._screenSide=t.screenSide}get id(){return this._id}get username(){return this._username}get ratio(){return this._ratio}get screenSide(){return this._screenSide}get characterInstance(){return this._characterInstance}get playerInstance(){return this._playerInstance}get levelInstance(){return this._levelInstance}set characterInstance(t){this._characterInstance=t}set playerInstance(t){this._playerInstance=t}set levelInstance(t){this._levelInstance=t}set ratio(t){this._ratio=t}}class p{constructor(t){e(this,"id"),e(this,"_details"),e(this,"stats"),e(this,"_textureKey"),e(this,"_thumbnailKey"),e(this,"_soundKey"),this.id=t.id,this._details=t.details,this.stats=t.stats,this._textureKey=`character${this.id}`,this._thumbnailKey=`character${this.id}Avatar`,this._soundKey=`character${this.id}Sound`}get textureKey(){return this._textureKey}get thumbnailKey(){return this._thumbnailKey}get soundKey(){return this._soundKey}get details(){return this._details}}class x{constructor(t){e(this,"scene"),e(this,"bar"),e(this,"barX"),e(this,"barY"),e(this,"barWidth"),e(this,"barHeight"),e(this,"barColor"),e(this,"barAlpha"),e(this,"box"),e(this,"boxX"),e(this,"boxY"),e(this,"boxWidth"),e(this,"boxHeight"),e(this,"boxColor"),e(this,"boxAlpha"),e(this,"text"),e(this,"_progressText"),this.scene=t.scene,this.bar=this.scene.add.graphics(),this.barWidth=400,this.barHeight=30,this.barX=i(this.scene)/2-this.barWidth/2,this.barY=a(this.scene)/2-this.barHeight/2,this.barColor=h,this.barAlpha=.8,this.box=this.scene.add.graphics(),this.boxWidth=this.barWidth+10,this.boxHeight=this.barHeight+10,this.boxX=i(this.scene)/2-this.boxWidth/2,this.boxY=a(this.scene)/2-this.boxHeight/2,this.boxColor=c,this.boxAlpha=.3,this.box.fillStyle(this.boxColor,this.boxAlpha),this.box.fillRect(this.boxX,this.boxY,this.boxWidth,this.boxHeight),this.text=this.scene.make.text({x:i(this.scene)/2,y:a(this.scene)/2+40,text:"Loading...",style:{font:"20px monospace"}}),this.text.setOrigin(.5,.5),this._progressText=this.scene.make.text({x:i(this.scene)/2,y:a(this.scene)/2,text:"0%",style:{font:"18px monospace"}}),this._progressText.setOrigin(.5,.5)}get progressText(){return this._progressText}draw(t){this.bar.clear(),this.bar.fillStyle(this.barColor,this.barAlpha),this.bar.fillRect(this.barX,this.barY,this.barWidth*t,this.barHeight)}destroy(){this.bar.destroy(),this.box.destroy(),this.text.destroy(),this.progressText.destroy()}}function g(){const t=localStorage.getItem("hoafight");return t?JSON.parse(t):{games:[]}}function b(t){const{games:e}=g(),s=e.filter((e=>e.winner===t)).length/e.length*100||0;return Math.round(s)}const k={active:!1,visible:!1,key:"Boot"};class f extends Phaser.Scene{constructor(){super(k),e(this,"levels"),e(this,"user1"),e(this,"user2"),e(this,"characters"),e(this,"loadingBar")}init(){this.user1=new m({id:1,username:"Player 1",ratio:b("user1"),screenSide:"left"}),this.user2=new m({id:2,username:"Player 2",ratio:b("user2"),screenSide:"right"}),this.levels=[new y({id:1,name:"Cimetiere"}),new y({id:2,name:"Prairie"})],this.characters=[new p({id:1,details:{nickname:"Stew"},stats:{}}),new p({id:2,details:{nickname:"Caroline"},stats:{}}),new p({id:3,details:{nickname:"Kristof"},stats:{}}),new p({id:4,details:{nickname:"Claudia"},stats:{}}),new p({id:5,details:{nickname:"Steven"},stats:{}}),new p({id:6,details:{nickname:"Zoya"},stats:{}})],this.data.set("user1",this.user1),this.data.set("user2",this.user2),this.data.set("characters",this.characters),this.data.set("levels",this.levels)}preload(){this.load.pack("preload","assets/pack.json","preload");for(let t=1;t<=this.characters.length;t++)this.load.atlas(`character${t}`,`assets/images/characters/character${t}/character${t}-spritesheet.png`,`assets/images/characters/character${t}/character${t}-atlas.json`);this.load.bitmapFont("Grobold","assets/fonts/grobold/grobold.png","assets/fonts/grobold/grobold.fnt"),this.loadingBar=new x({scene:this}),this.load.on("progress",(t=>{this.loadingBar.draw(t),this.loadingBar.progressText.setText(Math.floor(100*t)+"%")})),this.load.on("complete",(()=>{this.loadingBar.destroy()}))}create(){this.sound.add("menuTheme").play(),this.add.image(i(this)/2,a(this)/2,"backgroundMenu"),this.add.image(i(this)/2,a(this)/2-50,"mainLogo"),this.add.image(i(this)/2,52,"borderTop"),this.add.image(i(this)/2,a(this)-52,"borderBottom");const t=this.add.image(i(this)/2,a(this)-214,"textButtonWood").setInteractive({cursor:"pointer"}).on("pointerover",(()=>{t.setTexture("textButtonWoodSelected")})).on("pointerout",(()=>{t.setTexture("textButtonWood")})).on("pointerdown",(()=>{this.sound.add("clickSound").play(),this.cameras.main.fadeOut(),this.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.start("Menu",this.data.getAll())}))}));this.make.text({x:i(this)/2,y:a(this)-214,text:"START",style:{fontSize:"32px",fontFamily:d,align:"center",color:n}}).setOrigin(.5,.5)}}const S={active:!1,visible:!1,key:"Menu"};class w extends Phaser.Scene{constructor(){super(S),e(this,"levelThumb"),e(this,"clickSound"),e(this,"mapPicker"),e(this,"characterPickerUser1"),e(this,"characterPickerUser2"),e(this,"titleStyle")}init(t){this.mapPicker={window:{x:180,y:a(this)/2-90},title:{x:180,y:a(this)/2-184},thumbnail:{x:180,y:a(this)/2-36},button:{x:180,y:a(this)/2+95}},this.characterPickerUser1={window:{x:i(this)/2,y:a(this)/2-90},title:{x:i(this)/2,y:a(this)/2-184},thumbnail:{x:i(this)/2,y:a(this)/2-32},button:{x:i(this)/2,y:a(this)/2+95}},this.characterPickerUser2={window:{x:i(this)-180,y:a(this)/2-90},title:{x:i(this)-180,y:a(this)/2-184},thumbnail:{x:i(this)-180,y:a(this)/2-32},button:{x:i(this)-180,y:a(this)/2+95}},this.titleStyle={fontSize:"22px",fontFamily:d,align:"center",color:n},this.data.set("user1",t.user1),this.data.set("user2",t.user2),this.data.set("characters",t.characters),this.data.set("levels",t.levels),this.data.get("user1").levelInstance=this.data.get("levels").at(0),this.data.get("user1").characterInstance=this.data.get("characters").at(0),this.data.get("user2").levelInstance=this.data.get("levels").at(0),this.data.get("user2").characterInstance=this.data.get("characters").at(0),this.clickSound=this.sound.add("clickSound")}create(){this.cameras.main.fadeIn(),this.add.image(i(this)/2,a(this)/2,"backgroundMenu"),this.add.image(this.mapPicker.window.x,this.mapPicker.window.y,"windowBlank").setScale(.7,.7),this.levelThumb=this.add.image(this.mapPicker.thumbnail.x,this.mapPicker.thumbnail.y,this.data.get("levels").at(0).thumbnailKey).setScale(.7,.7),this.make.text({x:this.mapPicker.title.x,y:this.mapPicker.title.y,text:"TERRAIN",style:this.titleStyle}).setOrigin(.5,.5);const t=this.add.image(this.mapPicker.button.x,this.mapPicker.button.y,"tabWood").setInteractive({cursor:"pointer"}).on("pointerover",(()=>{t.setTexture("tabWoodSelected")})).on("pointerout",(()=>{t.setTexture("tabWood")})).on("pointerdown",(()=>{this.clickSound.play(),this.data.get("levels").push(this.data.get("levels").shift()),this.levelThumb.setTexture(this.data.get("levels").at(0).thumbnailKey),this.data.get("user1").levelInstance=this.data.get("levels").at(0),this.data.get("user2").levelInstance=this.data.get("levels").at(0)}));this.make.text({x:this.mapPicker.button.x,y:this.mapPicker.button.y,text:"NEXT",style:{fontSize:"22px",fontFamily:d,align:"center",color:n}}).setOrigin(.5,.5),this.add.image(this.characterPickerUser1.window.x,this.characterPickerUser1.window.y,"windowBlank").setScale(.7,.7);const e=this.add.image(this.characterPickerUser1.thumbnail.x,this.characterPickerUser1.thumbnail.y,this.data.get("characters").at(0).thumbnailKey).setScale(.8,.8);this.make.text({x:this.characterPickerUser1.title.x,y:this.characterPickerUser1.title.y,text:"PLAYER 1",style:this.titleStyle}).setOrigin(.5,.5);const s=this.add.image(this.characterPickerUser1.button.x,this.characterPickerUser1.button.y,"tabWood").setInteractive({cursor:"pointer"}).on("pointerover",(()=>{s.setTexture("tabWoodSelected")})).on("pointerout",(()=>{s.setTexture("tabWood")})).on("pointerdown",(()=>{this.clickSound.play(),this.data.get("characters").push(this.data.get("characters").shift()),e.setTexture(this.data.get("characters")[0].thumbnailKey),this.data.get("user1").characterInstance=this.data.get("characters")[0]}));this.make.text({x:this.characterPickerUser1.button.x,y:this.characterPickerUser1.button.y,text:"NEXT",style:{fontSize:"22px",fontFamily:d,align:"center",color:n}}).setOrigin(.5,.5),this.add.image(this.characterPickerUser2.window.x,this.characterPickerUser2.window.y,"windowBlank").setScale(.7,.7);const h=this.add.image(this.characterPickerUser2.thumbnail.x,this.characterPickerUser2.thumbnail.y,this.data.get("characters").at(0).thumbnailKey).setScale(.8,.8);this.make.text({x:this.characterPickerUser2.title.x,y:this.characterPickerUser2.title.y,text:"PLAYER 2",style:this.titleStyle}).setOrigin(.5,.5);const r=this.add.image(this.characterPickerUser2.button.x,this.characterPickerUser2.button.y,"tabWood").setInteractive({cursor:"pointer"}).on("pointerover",(()=>{r.setTexture("tabWoodSelected")})).on("pointerout",(()=>{r.setTexture("tabWood")})).on("pointerdown",(()=>{this.clickSound.play(),this.data.get("characters").push(this.data.get("characters").shift()),h.setTexture(this.data.get("characters")[0].thumbnailKey),this.data.get("user1").characterInstance=this.data.get("characters")[0]}));this.make.text({x:this.characterPickerUser2.button.x,y:this.characterPickerUser2.button.y,text:"NEXT",style:{fontSize:"22px",fontFamily:d,align:"center",color:n}}).setOrigin(.5,.5),this.data.set("user1",this.data.get("user1")),this.data.set("user2",this.data.get("user2"));const c=this.add.image(i(this)/2,a(this)-100,"textButtonWood").setInteractive({cursor:"pointer"}).on("pointerover",(()=>{c.setTexture("textButtonWoodSelected")})).on("pointerout",(()=>{c.setTexture("textButtonWood")})).on("pointerdown",(()=>{this.sound.add("clickSound").play(),this.cameras.main.fadeOut(),this.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.sound.stopAll(),this.scene.start("Game",this.data.getAll())}))}));this.make.text({x:i(this)/2,y:a(this)-100,text:"START",style:{fontSize:"32px",fontFamily:d,align:"center",color:n}}).setOrigin(.5,.5)}}class P extends Phaser.Physics.Arcade.Sprite{constructor(t){super(t.scene,t.x,t.y,t.textureKey),this.scene.physics.world.enable(this),this.scene.add.existing(this),this.setBounce(1),this.setVelocity(Phaser.Math.Between(-200,200),20),this.setGravityY(1e3)}isOut(){return this.y>a(this.scene)||this.y<0}handleReposition(){this.x>i(this.scene)?this.x=0:this.x<0&&(this.x=i(this.scene))}update(){this.handleReposition(),this.isOut()&&this.destroy()}}class K{constructor(t,e){"left"===e.screenSide?(t.add.image(0,0,e.characterInstance.thumbnailKey).setOrigin(0,0).setScale(.4),t.make.text({x:74,y:15,text:`${e.characterInstance.details.nickname} | ${e.username} | Ratio ${e.ratio}%`,style:{fontSize:"18px",fontFamily:d,color:n}})):"right"===e.screenSide&&(t.add.image(i(t),0,e.characterInstance.thumbnailKey).setOrigin(1,0).setScale(.4),t.make.text({x:i(t)-78,y:15,text:`${e.characterInstance.details.nickname} | ${e.username} | Ratio ${e.ratio}%`,style:{fontSize:"18px",fontFamily:d,color:n}}).setOrigin(1,0))}}class v extends Phaser.Physics.Arcade.Sprite{constructor(t){super(t.scene,t.x,t.y,t.textureKey),e(this,"vx"),e(this,"direction"),this.scene.physics.world.enable(this),this.scene.add.existing(this),this.vx=700,this.direction=t.direction,this.setVelocityX(this.direction*this.vx)}isOut(){return this.x>i(this.scene)||this.y>a(this.scene)||this.x<0||this.y<0}update(){this.isOut()&&(this.destroy(),console.log("Projectile destroyed cause out of world bounds"))}}class T extends Phaser.Physics.Arcade.Sprite{constructor(t){super(t.scene,t.x,t.y,t.textureKey),e(this,"_projectiles"),e(this,"healthBar"),e(this,"rightKey"),e(this,"leftKey"),e(this,"jumpKey"),e(this,"shootKey"),e(this,"lastPressedKey"),e(this,"jumpSound"),e(this,"shootSound"),e(this,"hitVoice"),e(this,"lastShoot"),e(this,"health"),e(this,"vx"),e(this,"gravityY"),e(this,"jumpVelocity"),e(this,"bounce"),e(this,"bulletProof"),e(this,"_collectedStuff"),e(this,"STATES",{NORMAL:"NORMAL",HURT:"HURT",DEAD:"DEAD",JUMPING:"JUMPING"}),this.scene.add.existing(this),this.initPhysics(),this.applyPhysics(),this.initSounds(),this.initVitals(),this.initHealthBar(t.healthBar),this.initShooting(),this.initControls(t.controlKeys),this._collectedStuff=0,this.setSize(20,60),this.setState(this.STATES.NORMAL)}get projectiles(){return this._projectiles}get collectedStuff(){return this._collectedStuff}handleReposition(){this.x>i(this.scene)?this.x=0:this.x<0&&(this.x=i(this.scene)),this.y>a(this.scene)&&(this.y=0)}collectStuff(){this._collectedStuff++}isDead(){return this.health<=0}hurt(){!this.bulletProof&&this.health>0&&(this.setState(this.STATES.HURT),this.health-=20,this.healthBar.decrease(20),this.hitVoice.play())}makeBulletProof(){!1===this.bulletProof&&(this.bulletProof=!0)}initSounds(){this.jumpSound=this.scene.sound.add("jumpSound"),this.shootSound=this.scene.sound.add("shootSound"),this.hitVoice=this.scene.sound.add("hitVoice")}initVitals(){this.health=100,this.bulletProof=!1}initPhysics(){this.gravityY=1e3,this.jumpVelocity=-600,this.vx=200,this.bounce=.2}applyPhysics(){this.scene.physics.world.enable(this),this.setGravityY(this.gravityY),this.setBounce(this.bounce),this.setCollideWorldBounds(!1)}initControls(t){this.scene.input.keyboard&&(this.jumpKey=this.scene.input.keyboard.addKey(t.jump),this.rightKey=this.scene.input.keyboard.addKey(t.right),this.leftKey=this.scene.input.keyboard.addKey(t.left),this.shootKey=this.scene.input.keyboard.addKey(t.shoot))}initHealthBar(t){this.healthBar=t}initShooting(){this.lastShoot=0,this._projectiles=this.scene.add.group({runChildUpdate:!0})}shoot(){this.scene.time.now>this.lastShoot&&(this._projectiles.add(new v({scene:this.scene,x:this.flipX?this.x-20:this.x+20,y:this.y+11,direction:this.lastPressedKey===this.leftKey?-1:1,textureKey:"projectile"})),this.lastShoot=this.scene.time.now+500,this.shootSound.play())}handleSpriteFlipping(){this.lastPressedKey===this.leftKey?this.flipX=!0:(this.lastPressedKey,this.rightKey,this.flipX=!1)}handleJumping(){var t,e;this.jumpKey.isDown&&((null==(t=this.body)?void 0:t.blocked.down)||(null==(e=this.body)?void 0:e.touching.down))&&(this.setVelocityY(this.jumpVelocity),this.jumpSound.play())}handleIdling(){this.setVelocityX(0),this.anims.play(`${this.texture.key}IDLE`,!0),this.shootKey.isDown&&(this.anims.play(`${this.texture.key}IDLE_SHOOT`,!0),this.shoot())}handleWalking(){this.anims.play(`${this.texture.key}WALK`,!0),this.rightKey.isDown&&(this.setVelocityX(this.vx),this.lastPressedKey=this.rightKey),this.leftKey.isDown&&(this.setVelocityX(-this.vx),this.lastPressedKey=this.leftKey),this.shootKey.isDown&&(this.anims.play(`${this.texture.key}WALK_SHOOT`,!0),this.shoot())}update(){this.handleReposition(),this.isDead()&&(this.state=this.STATES.DEAD),this.state===this.STATES.NORMAL&&(this.handleJumping(),this.handleSpriteFlipping(),this.rightKey.isDown||this.leftKey.isDown?this.handleWalking():this.handleIdling()),this.state===this.STATES.HURT&&(this.anims.play(`${this.texture.key}HIT`,!0),this.setVelocityX(0),this.scene.time.addEvent({delay:1e3,loop:!1,callback:()=>{this.setState(this.STATES.NORMAL)}})),this.state===this.STATES.DEAD&&(this.anims.play(`${this.texture.key}DEAD`,!0),this.setVelocityX(0))}}class I{constructor(t){e(this,"bar"),e(this,"x"),e(this,"y"),e(this,"width"),e(this,"height"),e(this,"healthValue"),this.bar=t.scene.add.graphics(),this.width=200,this.height=16,this.healthValue=200,"left"===t.side?(this.x=74,this.y=54):"right"===t.side&&(this.x=i(t.scene)-this.width-78,this.y=54),this.draw()}decrease(t){return this.healthValue-=2*t,this.healthValue<0&&(this.healthValue=0),this.draw(),0===this.healthValue}draw(){this.bar.clear(),this.bar.fillStyle(c),this.bar.fillRect(this.x,this.y,this.width,this.height),this.healthValue>60?this.bar.fillStyle(h):this.bar.fillStyle(r);let t=Math.floor(this.healthValue);this.bar.fillRect(this.x,this.y,t,this.height)}}class _{static createCharacterAnim(t,e){let s=e.characterInstance.textureKey;t.anims.create({key:`${s}WALK`,frames:t.anims.generateFrameNames(s,{prefix:"walk-side-armed",start:1,end:4,zeroPad:2}),frameRate:10,repeat:-1}),t.anims.create({key:`${s}WALK_SHOOT`,frames:t.anims.generateFrameNames(s,{prefix:"walk-side-shoot",start:1,end:4,zeroPad:2}),repeat:-1}),t.anims.create({key:`${s}IDLE`,frames:t.anims.generateFrameNames(s,{prefix:"idle-front-armed",start:1,end:4,zeroPad:2}),frameRate:10,repeat:-1}),t.anims.create({key:`${s}IDLE_SHOOT`,frames:t.anims.generateFrameNames(s,{prefix:"idle-front-shoot",start:1,end:1,zeroPad:2}),repeat:-1}),t.anims.create({key:`${s}HIT`,frames:t.anims.generateFrameNames(s,{prefix:"hit",start:1,end:1,zeroPad:2}),repeat:1}),t.anims.create({key:`${s}DEAD`,frames:t.anims.generateFrameNames(s,{prefix:"dead",start:1,end:1,zeroPad:2}),repeat:1})}}const U={active:!1,visible:!1,key:"Game"};class A extends Phaser.Scene{constructor(){super(U),e(this,"player1"),e(this,"player2"),e(this,"hud1"),e(this,"hud2"),e(this,"tilemap"),e(this,"bombs"),e(this,"collectables"),e(this,"bombCreationEvent"),e(this,"newSceneTimedEvent"),e(this,"winner"),e(this,"user1"),e(this,"user2"),e(this,"collectSound"),e(this,"currentGame")}setColliders(){this.physics.add.collider(this.bombs,this.tilemap.mainLayer),this.physics.add.collider(this.bombs,this.player1,(t=>{this.player1.hurt(),t.destroy()})),this.physics.add.collider(this.bombs,this.player2,(t=>{this.player2.hurt(),t.destroy()})),this.physics.add.collider(this.collectables,this.tilemap.mainLayer),this.physics.add.overlap([this.player1,this.player2],this.collectables,((t,e)=>{t.collectStuff(),e.destroy(),this.collectSound.play()})),this.physics.add.collider(this.player1,this.player2),this.physics.add.collider([this.player1,this.player2],this.tilemap.mainLayer),this.physics.add.collider(this.player2.projectiles,this.player1,(t=>{this.player1.hurt(),t.destroy()})),this.physics.add.collider(this.player1.projectiles,this.player2,(t=>{this.player2.hurt(),t.destroy()})),this.physics.add.collider(this.player1.projectiles,this.tilemap.mainLayer,(t=>{t.destroy()})),this.physics.add.collider(this.player2.projectiles,this.tilemap.mainLayer,(t=>{t.destroy()}))}init(t){this.user1=t.user1,this.user2=t.user2,_.createCharacterAnim(this,this.user1),_.createCharacterAnim(this,this.user2),this.currentGame={winner:"none",time:Date.now(),user1Collect:0,user2Collect:0}}create(){this.user1.levelInstance.create(this),this.tilemap=this.user1.levelInstance.tilemap,this.collectSound=this.sound.add("collectSound"),this.collectables=this.physics.add.group({key:"diamondPurple",repeat:11,bounceX:.4,bounceY:.4,allowGravity:!0,gravityY:300,setXY:{x:Math.floor(136*Math.random())+15,y:0,stepX:70}}),this.bombs=this.add.group({runChildUpdate:!0}),this.bombCreationEvent=this.time.addEvent({delay:5e3,loop:!0,callback:()=>{this.bombs.add(new P({scene:this,x:Phaser.Math.Between(50,i(this)-50),y:0,textureKey:"bomb"}))},callbackScope:this}),this.player1=new T({scene:this,x:300,y:300,textureKey:this.user1.characterInstance.textureKey,controlKeys:o,healthBar:new I({scene:this,side:"left"})}),this.player2=new T({scene:this,x:900,y:300,textureKey:this.user2.characterInstance.textureKey,controlKeys:l,healthBar:new I({scene:this,side:"right"})}),this.hud1=new K(this,this.user1),this.hud2=new K(this,this.user2),this.setColliders(),this.user1.playerInstance=this.player1,this.user2.playerInstance=this.player2}update(){this.player1.update(),this.player2.update(),(this.player1.isDead()||this.player2.isDead())&&(this.player1.makeBulletProof(),this.player2.makeBulletProof(),this.player1.isDead()&&!this.player2.isDead()?(this.winner=this.user2,this.currentGame.winner="user2"):!this.player1.isDead()&&this.player2.isDead()?(this.winner=this.user1,this.currentGame.winner="user1"):this.player2.isDead()&&this.player2.isDead()&&(this.winner=null,this.currentGame.winner="none"),this.currentGame.user1Collect=this.player1.collectedStuff,this.currentGame.user2Collect=this.player2.collectedStuff,this.data.set("winner",this.winner),this.data.set("user1",this.user1),this.data.set("user2",this.user2),this.data.set("currentGame",this.currentGame),this.newSceneTimedEvent=this.time.addEvent({delay:3e3,callback:()=>{this.sound.stopAll(),this.scene.start("Gameover",this.data.getAll())}}))}}const O={active:!1,visible:!1,key:"Gameover"};class E extends Phaser.Scene{constructor(){super(O),e(this,"games"),e(this,"characterPickerUser1"),e(this,"characterPickerUser2"),e(this,"titleStyle"),e(this,"user1"),e(this,"user2"),e(this,"winner")}init(t){this.user1=t.user1,this.user2=t.user2,this.winner=t.winner;const{games:e}=g();e.push(t.currentGame),function(t){localStorage.setItem("hoafight",JSON.stringify({games:t}))}(e),this.games=e,this.characterPickerUser1={window:{x:290,y:a(this)/2-90},title:{x:290,y:a(this)/2-184},thumbnail:{x:290,y:a(this)/2-36},button:{x:290,y:a(this)/2+86}},this.characterPickerUser2={window:{x:i(this)-290,y:a(this)/2-90},title:{x:i(this)-290,y:a(this)/2-184},thumbnail:{x:i(this)-290,y:a(this)/2-36},button:{x:i(this)-290,y:a(this)/2+86}},this.titleStyle={fontSize:"22px",fontFamily:d,align:"center",color:n}}create(){this.cameras.main.fadeIn(),this.add.image(i(this)/2,a(this)/2,"backgroundMenu"),this.add.image(i(this)/2,52,"borderTop"),this.add.image(i(this)/2,a(this)-52,"borderBottom"),this.add.image(this.characterPickerUser1.window.x,this.characterPickerUser1.window.y,"windowBlank").setScale(.7,.7),this.add.image(this.characterPickerUser1.thumbnail.x,this.characterPickerUser1.thumbnail.y,this.user1.characterInstance.thumbnailKey).setScale(.8,.8),this.make.text({x:this.characterPickerUser1.title.x,y:this.characterPickerUser1.title.y,text:"PLAYER 1",style:this.titleStyle}).setOrigin(.5,.5),this.add.image(this.characterPickerUser1.button.x,this.characterPickerUser1.button.y,"tabWood"),this.make.text({x:this.characterPickerUser1.button.x,y:this.characterPickerUser1.button.y,text:"Ratio "+b("user1")+"%",style:{fontSize:"22px",fontFamily:d,align:"center",color:n}}).setOrigin(.5,.5),this.add.image(this.characterPickerUser2.window.x,this.characterPickerUser2.window.y,"windowBlank").setScale(.7,.7),this.add.image(this.characterPickerUser2.thumbnail.x,this.characterPickerUser2.thumbnail.y,this.user2.characterInstance.thumbnailKey).setScale(.8,.8),this.make.text({x:this.characterPickerUser2.title.x,y:this.characterPickerUser2.title.y,text:"PLAYER 2",style:this.titleStyle}).setOrigin(.5,.5),this.add.image(this.characterPickerUser2.button.x,this.characterPickerUser2.button.y,"tabWood"),this.make.text({x:this.characterPickerUser2.button.x,y:this.characterPickerUser2.button.y,text:"Ratio "+b("user2")+"%",style:{fontSize:"22px",fontFamily:d,align:"center",color:n}}).setOrigin(.5,.5),this.add.image(this.winner.id===this.user1.id?this.characterPickerUser1.window.x:this.characterPickerUser2.window.x,a(this)/2-142,"goldMedal").setScale(.27,.27);const t=this.add.image(i(this)/2,a(this)-120,"textButtonWood").setScale(.8,.8).setInteractive({cursor:"pointer"}).on("pointerover",(()=>{t.setTexture("textButtonWoodSelected")})).on("pointerout",(()=>{t.setTexture("textButtonWood")})).on("pointerdown",(()=>{this.sound.add("clickSound").play(),this.cameras.main.fadeOut(),this.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.start("Menu")}))}));this.make.text({x:i(this)/2,y:a(this)-120,text:"MENU",style:{fontSize:"28px",fontFamily:d,align:"center",color:n}}).setOrigin(.5,.5)}}const C=[f,w,A,E],L={title:"Hoa Fight",type:s.AUTO,scale:{width:1024,height:640},input:{gamepad:!0,keyboard:!0},physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},dom:{createContainer:!0},parent:"game",scene:C};new s.Game(L);
